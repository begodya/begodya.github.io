<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="『修身养性，寻找灵感』">
<meta property="og:type" content="website">
<meta property="og:title" content="Begodya">
<meta property="og:url" content="http://begodya.com/index.html">
<meta property="og:site_name" content="Begodya">
<meta property="og:description" content="『修身养性，寻找灵感』">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Begodya">
<meta name="twitter:description" content="『修身养性，寻找灵感』">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://begodya.com/"/>





  <title>Begodya</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Begodya</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2018/10/30/web/快应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/30/web/快应用/" itemprop="url">快应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-30T15:59:30+08:00">
                2018-10-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h4><p>快应用是基于手机硬件平台的新型应用形态，标准是由主流的手机厂商组成的快应用联盟联合制定，包括小米、华为、金立、魅族、vivo、OPPO、一加、中兴、联想、努比亚，来实现10亿部设备上无需安装、即点即用。</p>
<h4 id="二、前置基础"><a href="#二、前置基础" class="headerlink" title="二、前置基础"></a>二、前置基础</h4><ul>
<li><p>需要一些必备的Web基础</p>
<ol>
<li>HTML5、CSS3、JS基础</li>
<li>ES6</li>
</ol>
</li>
<li><p>掌握基本的hap-toolkit的使用</p>
<ol>
<li>初始化项目</li>
<li>编译</li>
<li>调试</li>
<li>打包</li>
<li>…</li>
</ol>
</li>
<li><p>掌握快应用IDE的使用</p>
</li>
</ul>
<h4 id="三、主要内容"><a href="#三、主要内容" class="headerlink" title="三、主要内容"></a>三、主要内容</h4><ul>
<li><p>快应用与前端技术的异同点</p>
<ol>
<li>类似HTML语法，样式对CSS进行了一些裁剪和扩充，</li>
<li>不支持浮动<code>float</code>、绝对定位<code>absolute</code>、相对定位<code>relative</code>等</li>
<li>快应用的标签与HTML5标签含义不同    <ol>
<li>显示文本放置于<code>text</code>组件，不能放置于<code>div</code>组件<ol>
<li>基础组件中<code>a</code>和<code>text</code>组件支持内部嵌套组件，其它不支持</li>
<li><code>a</code>的子组件<code>span</code></li>
<li><code>text</code>的子组件<code>a</code>和<code>span</code></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p>样式书写</p>
<ol>
<li><p>盒模型：默认使用border-box模型，暂不支持content-box模型与box-sizing属性</p>
<ol>
<li><code>width</code>包括<code>padding</code>和<code>border</code></li>
<li><code>height</code>包括<code>padding</code>和<code>border</code></li>
</ol>
</li>
<li><p>长度单位</p>
<ol>
<li>px：与Web不一样，px是参考项目基准宽度，默认是750</li>
<li>%：参考父级</li>
<li>计算公式：设计稿1px / 设计稿基准宽度 = 框架样式1px / 项目配置基准宽度</li>
</ol>
</li>
<li><p>选择器支持</p>
<ol>
<li>id</li>
<li>class</li>
<li>tag</li>
<li>并列</li>
<li>后代</li>
</ol>
</li>
<li><p>样式引入</p>
<ol>
<li>内部</li>
<li>外部</li>
</ol>
</li>
</ol>
</li>
<li><p>快应用Flex布局</p>
<ol>
<li>主轴和交叉轴、容器和项目</li>
<li>快应用容器标签仅为<code>div</code>、<code>list-item</code>、<code>tabs</code></li>
<li>容器和项目各自支持的属性(截止1020版本)</li>
<li><p>容器属性</p>
<ol>
<li><code>flex-direction</code>（不支持 <code>*-reverse</code>）</li>
<li><code>flex-wrap</code></li>
<li><code>flex-flow</code>（不支持）</li>
<li><code>justify-content</code>（不支持<code>space-around</code>）</li>
<li><code>aline-items</code>（不支持<code>baseline</code>）</li>
<li><code>align-content</code></li>
</ol>
</li>
<li><p>项目属性    </p>
<ol>
<li><code>order</code>（不支持）</li>
<li><code>flex-gorw</code></li>
<li><code>flex-shrink</code></li>
<li><code>flex-basis</code>（和HTML5特性不一致）</li>
<li><code>flex</code>（和HTML5特性不一致）</li>
<li><code>align-self</code></li>
</ol>
</li>
<li><p>快应用Flex布局与HTML5对比总结<br><img src="http://oqleb1k16.bkt.clouddn.com/18-10-30/77353064.jpg" alt=""></p>
</li>
</ol>
</li>
</ul>
<h4 id="四、展示入口"><a href="#四、展示入口" class="headerlink" title="四、展示入口"></a>四、展示入口</h4><ul>
<li>vivo：应用商店、浏览器搜索、全局搜索、智慧桌面、桌面图标</li>
<li>华为：应用市场、桌面图标、负一屏、全局搜索、网页跳转</li>
<li>OPPO：桌面图标、软件商店、网页跳转、智慧识屏、负一屏、全局搜索、浏览器搜索、智能短信</li>
<li>金立：软件商店、负一屏、智能推送、桌面图标</li>
<li>魅族：全局搜索、应用商店、桌面图标</li>
<li>努比亚：应用中心、全局搜索、浏览器搜索、桌面图标</li>
<li>联想：应用中心、负一屏、桌面图标</li>
<li>小米：全局搜索、网页跳转、小爱同学、应用商店、桌面图标、场景化入口</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2018/04/12/android/如何让Swift在Android上运行/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/12/android/如何让Swift在Android上运行/" itemprop="url">如何让Swift在Android上运行？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-12T09:12:14+08:00">
                2018-04-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Swift标准库可以在armv7的Android机上编译，意味着可以在移动设备执行Swift代码来运行Android。以下为指导方案：</p>
<ol>
<li>如何在Android设备上运行样例程序“Hello, world”？</li>
<li>如何在目标Android系统和Android设备上运行Swift测试组件？</li>
</ol>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="是否意味着可以使用Swift来编写Android应用程序？"><a href="#是否意味着可以使用Swift来编写Android应用程序？" class="headerlink" title="是否意味着可以使用Swift来编写Android应用程序？"></a>是否意味着可以使用Swift来编写Android应用程序？</h3><p>不是的。虽然Swift编译器可以在Android设备上编译Swift代码，但编写App要比Swift标准库费事很多。你需要为你的应用编写一系列的图形交互框架，而这些Swift的标准库都没有提供。</p>
<p>另外，理论上可以通过Swift调用Java接口，但不同于Objective-C，Swift编译器没有Swift到Java的桥接方法。</p>
<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>需要以下指导条件：</p>
<ol>
<li>一个可以编译Swift源码的Linux环境，特指 Ubuntu 16.04或者 Ubuntu 15.10( Ubuntu 14.04近期没有测试)。目前标准库仅支持在Linux环境上进行编译Android。在试图构建Android之前，请确保可以通过Swift工程中的 <code>README</code> 文件来编译Linux。</li>
<li>最新版本Android NDK (r14) 可用下载地址：<a href="">http://developer.android.com/ndk/downloads/index.html</a></li>
<li>一台可供远程调试的Android设备，需要远程调试是为了部署标准库到设备上。可以按照官方指导来打开远程调试：<a href="">https://developer.chrome.com/devtools/docs/remote-debugging</a></li>
</ol>
<h2 id="一：Anroid上的”Hello-world”"><a href="#一：Anroid上的”Hello-world”" class="headerlink" title="一：Anroid上的”Hello, world”"></a>一：Anroid上的”Hello, world”</h2><h3 id="1-下载（或编译）Swift-Android标准库依赖"><a href="#1-下载（或编译）Swift-Android标准库依赖" class="headerlink" title="1. 下载（或编译）Swift Android标准库依赖"></a>1. 下载（或编译）Swift Android标准库依赖</h3><p>需要注意的是，为了在Linux上编译Swift标准库，需要<code>apt-get install libicu-dev icu-devtools</code>。同样，为Android编译Swift标准库需要 <code>libiconv</code> 和 <code>libicu</code> 库。</p>
<p>另外，如果你使用 Ubuntu 16.04，建议自己进行编译，步骤如下：</p>
<ol>
<li>确保已安装 <code>curl</code>, <code>autoconf</code>, <code>automake</code>, <code>libtool</code>, 和 <code>git</code>。</li>
<li>Clone 工程[SwiftAndroid/libiconv-libicu-android]，通过命令 <code>git clone https://github.com/SwiftAndroid/libiconv-libicu-android.git</code>。</li>
<li>命令行运行 <code>which ndk-build</code>，确保下载的Android NDK可执行，否则在 <code>PATH</code> 中添加Android NDK目录。</li>
</ol>
<h4 id="icu库中添加swift后缀"><a href="#icu库中添加swift后缀" class="headerlink" title="icu库中添加swift后缀"></a>icu库中添加<code>swift</code>后缀</h4><p>Android系统拥有自己的 icu 库，不同于我们生成的，并且与之有冲突。为了解决冲突，当Android设备中连接Swift标准库依赖时，我们需要在结尾添加<code>swift</code>后缀来更改icu库名，命令行进入<code>libiconv-libicu-android</code>目录，然后做以下步骤：</p>
<p>创建<code>armeabi-v7a</code>目录，通过解压<code>icu4c-55_1-src.tgz</code>文件生成<code>icu</code>目录，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ mkdir armeabi-v7a</div><div class="line">$ cd armeabi-v7a</div><div class="line">$ tar xvf ../icu4c-55_1-src.tgz</div></pre></td></tr></table></figure>
<p><strong>编辑icu配置文件</strong></p>
<p>为了防止icu配置文件从内部符号中添加<code>swift</code>后缀，编辑文件<code>icu/source/configure</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">if test &quot;$ICULIBSUFFIX&quot; != &quot;&quot;</div><div class="line">then</div><div class="line">    U_HAVE_LIB_SUFFIX=1</div><div class="line">    ICULIBSUFFIXCNAME=`echo _$ICULIBSUFFIX | sed &apos;s/^A-Za-z0-9_/_/g&apos;`</div><div class="line">    UCONFIG_CPPFLAGS=&quot;$&#123;UCONFIG_CPPFLAGS&#125; -DU_HAVE_LIB_SUFFIX=1 -DU_LIB_SUFFIX_C_NAME=$&#123;ICULIBSUFFIXCNAME&#125; &quot;</div><div class="line">else</div><div class="line">    U_HAVE_LIB_SUFFIX=0</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>更改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#if test &quot;$ICULIBSUFFIX&quot; != &quot;&quot;</div><div class="line">#then</div><div class="line">#    U_HAVE_LIB_SUFFIX=1</div><div class="line">#    ICULIBSUFFIXCNAME=`echo _$ICULIBSUFFIX | sed &apos;s/^A-Za-z0-9_/_/g&apos;`</div><div class="line">#    UCONFIG_CPPFLAGS=&quot;$&#123;UCONFIG_CPPFLAGS&#125; -DU_HAVE_LIB_SUFFIX=1 -DU_LIB_SUFFIX_C_NAME=$&#123;ICULIBSUFFIXCNAME&#125; &quot;</div><div class="line">#else</div><div class="line">    U_HAVE_LIB_SUFFIX=0</div><div class="line">#fi</div></pre></td></tr></table></figure>
<p><strong><em>编辑文件build.sh</em></strong></p>
<p>现在回退到<code>libiconv-libicu-android</code>根目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ cd ..</div></pre></td></tr></table></figure>
<p>为了防止<code>build.sh</code>重新生成icu目录和覆盖刚修改的<code>configure</code>文件，编辑<code>build.sh</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ -e ../icu4c-55_1-src.tgz ] || exit 1</div><div class="line">tar xvf ../icu4c-55_1-src.tgz</div></pre></td></tr></table></figure>
<p>更改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#[ -e ../icu4c-55_1-src.tgz ] || exit 1</div><div class="line">#tar xvf ../icu4c-55_1-src.tgz</div></pre></td></tr></table></figure>
<p>为了验证<code>libicuucswift.so</code>文件，修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -e libicuuc.so ] || &#123;</div></pre></td></tr></table></figure>
<p>为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -e libicuucswift.so ] || &#123;</div></pre></td></tr></table></figure>
<p>然后在<code>configure</code>文件中增加<code>swift</code>后缀，修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">./configure \</div><div class="line">--host=arm-linux-androideabi \</div><div class="line">--prefix=`pwd`/../../ \</div><div class="line">--with-cross-build=`pwd`/cross \</div><div class="line">--enable-static --enable-shared \</div><div class="line">|| exit 1</div></pre></td></tr></table></figure>
<p>为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">./configure \</div><div class="line">--host=arm-linux-androideabi \</div><div class="line">--prefix=`pwd`/../../ \</div><div class="line">--with-library-suffix=swift \</div><div class="line">--with-cross-build=`pwd`/cross \</div><div class="line">--enable-static --enable-shared \</div><div class="line">|| exit 1</div></pre></td></tr></table></figure>
<p>最后给每一个库文件名添加<code>swift</code>，修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for f in libicudata libicutest libicui18n libicuio libicule libiculx libicutu libicuuc; do</div></pre></td></tr></table></figure>
<p>为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for f in libicudataswift libicutestswift libicui18nswift libicuioswift libiculeswift libiculxswift libicutuswift libicuucswift; do</div></pre></td></tr></table></figure>
<p><strong><em>运行build.sh</em></strong></p>
<p>准备开始运行<code>build.sh</code>文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ./build.sh</div></pre></td></tr></table></figure>
<p>确认在<code>libiconv-libicu-android</code>目录中创建<code>armeabi-v7a/icu/source/i18n</code>和<code>armeabi-v7a/icu/source/common</code>目录。</p>
<h3 id="2-为Android编译Swift标准库"><a href="#2-为Android编译Swift标准库" class="headerlink" title="2. 为Android编译Swift标准库"></a>2. 为Android编译Swift标准库</h3><p>进入Swift目录，然后运行编译脚本，添加Android NDK路径，步骤如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ utils/build-script \</div><div class="line">    -R \                                       # Build in ReleaseAssert mode.</div><div class="line">    --android \                                # Build for Android.</div><div class="line">    --android-ndk /path/to/android-ndk-r14 \   # Path to an Android NDK.</div><div class="line">    --android-api-level 21 \                   # The Android API level to target. Swift only supports 21 or greater.</div><div class="line">    --android-icu-uc /path/to/libicu-android/armeabi-v7a \</div><div class="line">    --android-icu-uc-include /path/to/libicu-android/armeabi-v7a/icu/source/common \</div><div class="line">    --android-icu-i18n /path/to/libicu-android/armeabi-v7a \</div><div class="line">    --android-icu-i18n-include /path/to/libicu-android/armeabi-v7a/icu/source/i18n</div></pre></td></tr></table></figure>
<h3 id="3-在Android设备上编译并运行hello-swift"><a href="#3-在Android设备上编译并运行hello-swift" class="headerlink" title="3. 在Android设备上编译并运行hello.swift"></a>3. 在Android设备上编译并运行<code>hello.swift</code></h3><p>创建一个名为<code>hello.swift</code>的Swift样例文件：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">print</span>(<span class="string">"Hello, Android"</span>)</div></pre></td></tr></table></figure>
<p>为了成功编译，需要确保使用正确的链接。在<code>PATH</code>中增加gold链接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo ln -s \</div><div class="line">    /path/to/android-ndk-r14/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/arm-linux-androideabi/bin/ld.gold \</div><div class="line">    /usr/bin/armv7-none-linux-androideabi-ld.gold</div></pre></td></tr></table></figure>
<p>然后针对Android使用Swift编译器来编译Swift源码文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ build/Ninja-ReleaseAssert/swift-linux-x86_64/bin/swiftc \                      # The Swift compiler built in the previous step.</div><div class="line">                                                                                 # The location of the tools used to build Android binaries</div><div class="line">    -tools-directory /path/to/android-ndk-r14/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/arm-linux-androideabi/bin</div><div class="line">    -target armv7-none-linux-androideabi \                                       # Targeting android-armv7.</div><div class="line">    -sdk /path/to/android-ndk-r14/platforms/android-21/arch-arm \                # Use the same NDK path and API version as you used to build the stdlib in the previous step.</div><div class="line">    -L /path/to/android-ndk-r14/sources/cxx-stl/llvm-libc++/libs/armeabi-v7a \   # Link the Android NDK&apos;s libc++ and libgcc.</div><div class="line">    -L /path/to/android-ndk-r14/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/lib/gcc/arm-linux-androideabi/4.9.x \</div><div class="line">    hello.swift</div></pre></td></tr></table></figure>
<p>这会在目录中生成一个<code>hello</code>可执行文件。如果试图使用Linux环境去运行这个可执行文件，会出现下面错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cannot execute binary file: Exec format error</div></pre></td></tr></table></figure>
<p>这就是我们想要的错误：这是个可以在Android设备上运行的可执行文件，而不是在Linux上，我们可以把它部署在Android设备上去执行它。</p>
<h3 id="4-在设备上部署构建的产品"><a href="#4-在设备上部署构建的产品" class="headerlink" title="4. 在设备上部署构建的产品"></a>4. 在设备上部署构建的产品</h3><p>可以使用<code>adb push</code>命令从Linux环境中复制一份构建的产品到Android设备上。如果还未安装<code>adb</code>，可以通过<code>apt-get</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install android-tools-adb</div></pre></td></tr></table></figure>
<p>一旦完成安装<code>adb</code>，即可验证设备已经关联，当运行<code>adb devices</code>命令 - <strong>currently this example works only in devices / emulators with at least Android 7.0, API 24</strong> - 然后运行以下命令来复制Swift Android标准库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ adb push build/Ninja-ReleaseAssert/swift-linux-x86_64/lib/swift/android/libswiftCore.so /data/local/tmp</div><div class="line">$ adb push build/Ninja-ReleaseAssert/swift-linux-x86_64/lib/swift/android/libswiftGlibc.so /data/local/tmp</div><div class="line">$ adb push build/Ninja-ReleaseAssert/swift-linux-x86_64/lib/swift/android/libswiftSwiftOnoneSupport.so /data/local/tmp</div><div class="line">$ adb push build/Ninja-ReleaseAssert/swift-linux-x86_64/lib/swift/android/libswiftRemoteMirror.so /data/local/tmp</div><div class="line">$ adb push build/Ninja-ReleaseAssert/swift-linux-x86_64/lib/swift/android/libswiftSwiftExperimental.so /data/local/tmp</div></pre></td></tr></table></figure>
<p>同样需要推送icu库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">adb push /path/to/libicu-android/armeabi-v7a/libicudataswift.so /data/local/tmp</div><div class="line">adb push /path/to/libicu-android/armeabi-v7a/libicui18nswift.so /data/local/tmp</div><div class="line">adb push /path/to/libicu-android/armeabi-v7a/libicuucswift.so /data/local/tmp</div></pre></td></tr></table></figure>
<p>另外，还需要复制Android NDK的libc++：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ adb push /path/to/android-ndk-r14/sources/cxx-stl/llvm-libc++/libs/armeabi-v7a/libc++_shared.so /data/local/tmp</div></pre></td></tr></table></figure>
<p>最后，需要复制在先前构建的<code>hello</code>可执行文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ adb push hello /data/local/tmp</div></pre></td></tr></table></figure>
<h3 id="5-在Android设备上运行”Hello-world”"><a href="#5-在Android设备上运行”Hello-world”" class="headerlink" title="5. 在Android设备上运行”Hello, world”"></a>5. 在Android设备上运行”Hello, world”</h3><p>可以在Android设备上使用<code>adb shell</code>命令来执行<code>hello</code>可执行文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ adb shell LD_LIBRARY_PATH=/data/local/tmp /data/local/tmp/hello</div></pre></td></tr></table></figure>
<p>将会看到如下输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hello, Android</div></pre></td></tr></table></figure>
<p>恭喜！已经完成在Android上的第一份Swift程序。</p>
<h2 id="二：在Android设备上运行Swift测试组件"><a href="#二：在Android设备上运行Swift测试组件" class="headerlink" title="二：在Android设备上运行Swift测试组件"></a>二：在Android设备上运行Swift测试组件</h2><p>当运行测试组件的时候，构建的产品会自动推送到设备上。同第一部分一样，需要通过USB来关联Android设备：</p>
<ol>
<li>通过USB连接Android设备和电脑。确保按照官方指导打开远程调试：<a href="">https://developer.chrome.com/devtools/docs/remote-debugging</a>。</li>
<li>运行<code>adb devices</code>确认设备已经连接，应该查看上设备列表。</li>
<li>使用构建脚本运行测试：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ utils/build-script \</div><div class="line">  -R \                                           # Build in ReleaseAssert mode.</div><div class="line">  -T \                                           # Run all tests.</div><div class="line">  --android \                                    # Build for Android.</div><div class="line">  --android-ndk ~/android-ndk-r13 \              # Path to an Android NDK.</div><div class="line">  --android-ndk-version 21 \</div><div class="line">  --android-icu-uc ~/libicu-android/armeabi-v7a/libicuuc.so \</div><div class="line">  --android-icu-uc-include ~/libicu-android/armeabi-v7a/icu/source/common \</div><div class="line">  --android-icu-i18n ~/libicu-android/armeabi-v7a/libicui18n.so \</div><div class="line">  --android-icu-i18n-include ~/libicu-android/armeabi-v7a/icu/source/i18n/</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2018/03/28/iOS/Swift标准库源码阅读（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/28/iOS/Swift标准库源码阅读（一）/" itemprop="url">Swift标准库源码阅读（一）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-28T15:24:47+08:00">
                2018-03-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="开发环境和项目结构"><a href="#开发环境和项目结构" class="headerlink" title="开发环境和项目结构"></a>开发环境和项目结构</h3><ul>
<li>编译步骤</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># 安装 cmake 和 ninja</div><div class="line">brew install cmake ninja</div><div class="line">    </div><div class="line">mkdir swift-source</div><div class="line">cd swift-source</div><div class="line"></div><div class="line"># 将 Swift 主项目 clone 到本地</div><div class="line">git clone https://github.com/apple/swift.git</div><div class="line"></div><div class="line"># 使用 update-checkout 脚本更新所有 repo</div><div class="line">./swift/utils/update-checkout --clone</div><div class="line"></div><div class="line">./swift/utils/build-script --release-debuginfo</div></pre></td></tr></table></figure>
<ul>
<li>编译Swift</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/18-3-28/53284569.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/18-3-28/26935950.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/18-3-28/37463335.jpg" alt=""></p>
<p>以上为机器配置，当前版本下整个全新编译的过程耗时为30分钟。</p>
<ul>
<li>编译模式</li>
</ul>
<p>编译脚本中的<code>--release-debuginfo</code>选项表示<code>RelWithDebInfo</code>模式来进行编译；</p>
<p>其他如<code>--release</code>选项表示版本追求了最大的性能优化，抛弃了调试信息；</p>
<p><code>--debug</code>选项表示版本保留了全部的调试信息，而放弃了速度的优化；</p>
<p><code>--release-debuginfo</code>选项表示版本结合了两者的优点，为了迅速的执行，代码经过了优化，但同时在编译期间也生成了调试用的数据和部分调试行，这让 debugger 有机会 catch 到出问题的代码空间是哪个部分。</p>
<p>不过，在实际开发中，这种有限的调试信息往往只能作为参考，如果确实需要寻找问题或加挂 debugger，还是需要使用 Debug 模式来编译。</p>
<ul>
<li>项目结构</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/18-3-28/25339637.jpg" alt=""></p>
<p>Swift 标准库的源码大部分存放在<code>swift/stdlib/public</code>中，其中<code>core</code>文件夹下包括标准库中如<code>String</code>，<code>Array</code>等主要类型；<code>SDK</code>文件夹下是针对对应平台的代码、框架相关代码如 UIKit 和 Foundation等。</p>
<p>在macOS下，用ninja进行编译后的产品会被放在<code>build/Ninja-RelWithDebInfoAssert/swift-macosx-x86_64</code>下，如<br><img src="http://oqleb1k16.bkt.clouddn.com/18-3-29/7578028.jpg" alt=""></p>
<ul>
<li>更新项目</li>
</ul>
<p>再次使用<code>./swift/utils/update-checkout</code>就可以将包括Swift自身在内的所有项目更新到最新的 master。</p>
<ul>
<li>测试</li>
</ul>
<p>Swift项目的测试主要位于<code>swift/test</code>和<code>swift/validation-test</code>下，前者是一般性的测试，后者包含了功能验证和回归测试。</p>
<p>可使用下面命令运行所有测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># -r 编译并运行 test</div><div class="line">./swift/utils/build-script -r -t</div><div class="line"></div><div class="line"># -r 编译并运行 validation test</div><div class="line">./swift/utils/build-script -r -T</div></pre></td></tr></table></figure>
<p>只要运行一过一次测试，测试套件将会被生成并放在编译结果文件夹的对应<code>test</code>或<code>validation-test</code>文件夹下。我们可以通过<code>utils/lit</code>下的<code>lit.py</code>工具来指定只运行某一套或者某一个测试。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2018/03/27/android/Android的进程和线程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/27/android/Android的进程和线程/" itemprop="url">Android的进程和线程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-27T15:35:07+08:00">
                2018-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>线程是CPU调度的最小单元，同时线程也是一种有限的资源。</p>
<p>进程一般指一个执行单元，在PC和移动设备上指一个程序或一个应用，一个进程可包含多个线程。</p>
<p>对Android来讲，它是一种基于Linux的移动操作系统。当一个程序第一次启动的时候，Android会启动一个Linux进程和一个主线程。</p>
<h3 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h3><p>移动设备上没有无限的内存、无限的电池或者其它无限的资源，这对应用而言意味着应该把进程死亡作为应用生命周期的一个自然过程对待，最重要的是确保杀死进程及内存回收不会对用户造成负面影响。默认情况下，同一应用的所有组件均在相同的进程中进行，且大多数应用都不会改变这一点。事实上，Android中的多数进程架构都是为了确保特定的顺序而特别设计的，并按重要性层次遵循一组模式。</p>
<p>进程优先级</p>
<p><img src="http://7xkc0v.com1.z0.glb.clouddn.com/wp-content/uploads/2016/01/0-yGCYcQQsVmaT3Ukf.png" alt=""></p>
<ol>
<li><p>前台进程</p>
<p> 用户当前操作所必需的进程。</p>
<p> 通常，在任意给定时间前台进程都为数不多。只有在内存不足以支持它们同时继续运行这一万不得已的情况下，系统才会终止它们。此时，设备往往已达到内存分页状态，因此需要终止一些前台进程来确保用户界面正常响应，这就需要依靠系统的资源。</p>
</li>
<li><p>可见进程</p>
<p> 没有任何前台组件，但仍会影响用户在屏幕上所见内容的进程。</p>
<p> 可见进程被视为是极其重要的进程，除非为了维持所有前台同时运行而必须终止，否则系统不会终止这些进程。</p>
</li>
<li><p>服务进程</p>
<p> 正在运行已使用startService()方法启动的服务且不属于上述两个更高类别进程的进程。尽管服务进程与用户所见内容没有直接关联，但它们通常在执行一些用户关心的操作（后台播放或网络下载数据等）。因此，除非内存不足以维持所有前台进程和可见进程同时运行，否则系统会让服务进程保持运行状态。</p>
</li>
<li><p>后台进程</p>
<p> 包含目前对用户不可见的Activity进程（已调用Activity的onStop()方法）。这些进程对用户体验没有直接影响，系统可能随时终止它们，以回收内存供前台进程、可见进程或服务进程使用。</p>
</li>
<li><p>空进程</p>
<p> 不包含任意应用活动组件的进程。保留这种进程的唯一目的是用作缓存，以缩短下次在其中运行组件所需的启动时间。为使总体系统资源在进程缓存和底层内核缓存之间保持平衡，系统往往会终止这些进程。</p>
</li>
</ol>
<h3 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h3><p>从用途上来讲，线程分为主线和和子线程，主线程作用是「运行四大组件以及处理它们和用户的交互」，而子线程作用是「执行耗时任务，比如网络请求 、I/0操作等」。</p>
<ul>
<li><p>AsyncTask</p>
<p>  封装了线程池和Handler，主要是为了方便开发者在子线程中更新UI。</p>
</li>
<li><p>HandlerThread</p>
<p>  一种具有消息循环的线程，内部可使用Handler。</p>
</li>
<li><p>IntentService</p>
<p>  内部采用HandlerThread来执行任务，当任务执行完毕后IntentService会自动</p>
</li>
<li><p>主线程</p>
<p>  Android系统要求网络访问必须在子线程中进行，否则网络访问会失败并抛出异常，目的是为了避免主线程由于被耗时操作阻塞从而出现ANR现象。</p>
<p>  访问UI只能在主线程中进行，如果在子线程中访问UI，程序会抛出异常。因为Android的UI控件不是线程安全的，如果在多线程中并发访问可能会导致UI控件处于不可预期的状态。</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2018/03/15/architecture/2018个人计划/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/15/architecture/2018个人计划/" itemprop="url">2018年个人计划</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-15T12:02:25+08:00">
                2018-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h4><ol>
<li>Swift技术精进</li>
<li>面向协议编程</li>
<li>AR技术研究</li>
<li>熟悉当前常用框架</li>
<li>关注行业技术发展</li>
</ol>
<h4 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h4><ol>
<li>Kotlin技术精进</li>
<li>函数响应式编程</li>
<li>熟悉当前常用框架</li>
<li>关注行业技术发展</li>
</ol>
<h4 id="小程序"><a href="#小程序" class="headerlink" title="小程序"></a>小程序</h4><ol>
<li>时刻关注开放功能</li>
<li>了解小程序各种营销方法</li>
</ol>
<h4 id="其他技术"><a href="#其他技术" class="headerlink" title="其他技术"></a>其他技术</h4><ol>
<li>了解机器学习各算法</li>
<li>关注区块链技术发展</li>
<li>关注前端技术发展</li>
<li>TCP/IP、UDP详解</li>
<li>设计模式</li>
</ol>
<h4 id="管理"><a href="#管理" class="headerlink" title="管理"></a>管理</h4><ol>
<li>上半年主要精力在小程序矩阵化的开发及管理上</li>
<li>下半年主要精力在App平台化的开发及管理上</li>
</ol>
<h4 id="阅读"><a href="#阅读" class="headerlink" title="阅读"></a>阅读</h4><ol>
<li>读书笔记</li>
<li>坚持写博客</li>
</ol>
<h4 id="健康"><a href="#健康" class="headerlink" title="健康"></a>健康</h4><p>坚持锻炼</p>
<h4 id="格局"><a href="#格局" class="headerlink" title="格局"></a>格局</h4><p>行万里路</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2018/01/24/architecture/微信小程序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/24/architecture/微信小程序/" itemprop="url">微信小程序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-24T11:49:26+08:00">
                2018-01-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="小程序推广方式"><a href="#小程序推广方式" class="headerlink" title="小程序推广方式"></a>小程序推广方式</h4><ol>
<li>关联公众号：同一主体可关联10个小程序，不同主体可关联3个小程序，小程序可关联500个公众号</li>
<li>非关联公众号：二维码（数量10万、永久有效）、小程序码（数量无限制、永久有效）</li>
</ol>
<h4 id="小程序进入场景（五十）"><a href="#小程序进入场景（五十）" class="headerlink" title="小程序进入场景（五十）"></a>小程序进入场景（五十）</h4><blockquote>
<ul>
<li>1001: 发现栏小程序主入口</li>
<li>1005: 顶部搜索框的搜索结果页</li>
<li>1006: 发现栏小程序入口搜索框的搜索结果页</li>
<li>1007: 单人聊天会话中的小程序消息卡片</li>
<li>1008: 群聊会话中的小程序消息卡片</li>
<li>1011: 扫描二维码</li>
<li>1012: 长按图片识别二维码</li>
<li>1013: 手机相册选取二维码</li>
<li>1014: 小程序模版消息</li>
<li>1017: 前往体验版的入口页</li>
<li>1019: 微信钱包</li>
<li>1020: 公众号profile页相关小程序列表</li>
<li>1022: 聊天顶部置顶小程序入口</li>
<li>1023: 安卓系统桌面图标</li>
<li>1024: 小程序profile页</li>
<li>1025: 扫描一维码</li>
<li>1026: 附近小程序列表</li>
<li>1027: 顶部搜索框搜索结果页“使用过的小程序”列表</li>
<li>1028: 我的卡包</li>
<li>1029: 卡券详情页</li>
<li>1031: 长按图片识别一维码</li>
<li>1032: 手机相册选取一维码</li>
<li>1034: 微信支付完成页</li>
<li>1035: 公众号自定义菜单</li>
<li>1036: App分享消息卡片</li>
<li>1037: 从小程序进入</li>
<li>1038: 从小程序返回</li>
<li>1039: 摇电视</li>
<li>1042: 添加好友搜索框的搜索结果页</li>
<li>1043: 公众号模板消息</li>
<li>1044: 带shareTicket的小程序消息卡片</li>
<li>1047: 扫描小程序码</li>
<li>1048: 长按图片识别小程序码</li>
<li>1049: 手机相册选取小程序码</li>
<li>1052: 卡券的适用门店列表</li>
<li>1053: 搜一搜的结果页</li>
<li>1054: 顶部搜索框小程序快捷入口</li>
<li>1056: 音乐播放器菜单</li>
<li>1058: 公众号文章</li>
<li>1059: 体验版小程序绑定邀请页</li>
<li>1064: 微信连Wifi状态栏</li>
<li>1067: 公众号文章广告</li>
<li>1068: 附近小程序列表广告</li>
<li>1072: 二维码收款页面</li>
<li>1073: 客服消息列表下发的小程序消息卡片</li>
<li>1074: 公众号会话下发的小程序消息卡片</li>
<li>1078: 连wifi成功页</li>
<li>1089: 微信聊天主界面下拉</li>
<li>1090: 长按小程序右上角菜单唤出最近使用历史</li>
<li>1092: 城市服务入口</li>
</ul>
</blockquote>
<h4 id="小程序消息推送"><a href="#小程序消息推送" class="headerlink" title="小程序消息推送"></a>小程序消息推送</h4><blockquote>
<p>下发条件说明</p>
</blockquote>
<pre><code>支付

当用户在小程序内完成过支付行为，可允许开发者向用户在7天内推送有限条数的模板消息（1次支付可下发3条，多次支付下发条数独立，互相不影响）

提交表单

当用户在小程序内发生过提交表单行为且该表单声明为要发模板消息的，开发者需要向用户提供服务时，可允许开发者向用户在7天内推送有限条数的模板消息（1次提交表单可下发1条，多次提交下发条数独立，相互不影响）
</code></pre><p>突破小程序推送限制做法：</p>
<p><img src="http://img.mp.itc.cn/upload/20170726/7eeeb27b5ab64cb0b2da399d006556e6.jpg" alt=""></p>
<h4 id="小程序与公众号、APP之跳转"><a href="#小程序与公众号、APP之跳转" class="headerlink" title="小程序与公众号、APP之跳转"></a>小程序与公众号、APP之跳转</h4><p><img src="http://oqleb1k16.bkt.clouddn.com/18-1-27/63671553.jpg" alt=""></p>
<ul>
<li>官方支持公众号关联小程序进行跳转：</li>
</ul>
<ol>
<li>公众号介绍页：相关小程序</li>
<li>公众号自定义菜单：可设置一级菜单或二级菜单</li>
<li>公众号模板消息：    关联时下发</li>
<li>公众号图文消息：小程序卡片、文字链接、图片链接</li>
</ol>
<ul>
<li>官方暂不支持小程序跳转公众号操作，可通过小程序内客服进行自动推送公众号推文，文内有公众号二维码信息，可引导用户长按扫描后，即可跳转到对应公众号进行关注操作；但目前因小程序页面路径控制（限制五层），iOS在第二层页面之后进行跳转客服引导关注，会导致下次从小程序快捷入口进来后，当前页面会冻结，无法进行交互。</li>
</ul>
<p><img src="https://mp.weixin.qq.com/debug/wxadoc/dev/image/launch-app.png?t=2018125" alt=""></p>
<ul>
<li><p>APP可通过分享方式，在微信内打开小程序。</p>
</li>
<li><p>小程序在从APP分享至微信的小程序页面，用户访问时支持打开来源应用。在一个小程序的生命周期内，只有在特定条件下，才具有打开 APP 的能力。<code>打开 APP 的能力</code>可以理解为由小程序框架在内部管理的一个状态，为 true 则可以打开 APP，为 false 则不可以打开 APP。 </p>
</li>
</ul>
<blockquote>
<pre><code> 在小程序的生命周期内，这个状态的初始值为 false，之后会随着小程序的每次打开（无论是启动还是切到前台）而改变：  

当小程序从 1036（App 分享消息卡片） 打开时，该状态置为 true。
当小程序从 1089（微信聊天主界面下拉）或 1090（长按小程序右上角菜单唤出最近使用历史）的场景打开时，该状态不变，即保持上一次打开小程序时该状态的值。
当小程序从非 1036/1089/1090 的场景打开，该状态置为 false。
</code></pre></blockquote>
<h4 id="手机操作系统、APP、小程序、H5之关系"><a href="#手机操作系统、APP、小程序、H5之关系" class="headerlink" title="手机操作系统、APP、小程序、H5之关系"></a>手机操作系统、APP、小程序、H5之关系</h4><p>手机操作系统 = S座</p>
<p>APP = 公司</p>
<p>小程序 = 小e微店</p>
<p>H5 = 海报</p>
<p>手机操作系统就相当于S座楼，楼内的每家公司就相当于各个APP，善诊公司相当于微信APP，公司内的小e微店就相当于小程序，零食区所拥有的空间相当于小程序的2M空间，后面又扩展出咖啡售卖区就相当于小程序分包机制，可扩展到4M；H5相当于海报，理论上可张贴于公司的各个位置。</p>
<p>目前，小程序所属于微信，未来大一统的形态，可能是小程序形成SDK，各家APP均可按需嵌入自己需要关联的小程序，形成更大的关系网。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2017/10/09/world/川渝行/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/09/world/川渝行/" itemprop="url">世界迷雾之十一川渝行</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-09T15:54:15+08:00">
                2017-10-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="规划"><a href="#规划" class="headerlink" title="规划"></a>规划</h2><p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/35311761.jpg" alt=""></p>
<h2 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h2><p>2017年9月30日-2017年10月7日 更改为 2017年9月30日-2017年10月6日<br><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/81286150.jpg" alt=""></p>
<p>从九月初就开始用穷游助手规划行程：<a href="http://plan.qyer.com/trip/V2UJYlFvBzdTbVI3CmkNNg/?campaign=app_share_plan&amp;category=myplan_weixin&amp;client_id=qyer_planner_ios&amp;share_platform=myplan_weixin&amp;style=deepgreen&amp;track_user_id=9418556" target="_blank" rel="external">十一川渝行</a></p>
<h2 id="第一站：成都（9-30-10-1）"><a href="#第一站：成都（9-30-10-1）" class="headerlink" title="第一站：成都（9.30-10.1）"></a>第一站：成都（9.30-10.1）</h2><p>中午十二点左右从浦东国际机场乘机，到成都双流机场下午三点左右，打车到酒店休息了半个小时，就乐颠颠的骑着小黄车奔去锦里了，也就五点左右了，里面逛了逛，吃了些小吃，之前同事推荐去附近的皇城坝尝尝地产的成都美食。后来才想起来，夜色下的锦里才是最美的啊~</p>
<ul>
<li>锦里</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/21062154.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/65027791.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/77256860.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/39515258.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/26687082.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/54589198.jpg" alt=""></p>
<ul>
<li>武侯祠</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/51335056.jpg" alt=""></p>
<ul>
<li>皇城坝</li>
</ul>
<p>做美食直播的<br><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/24459082.jpg" alt=""></p>
<p>点了一份甜水面<br><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/32306857.jpg" alt=""></p>
<ul>
<li>钢管厂</li>
</ul>
<p>在去酒店的出租上，司机师傅推荐成都的钢管厂串串，皇城坝出来后就在寻觅着，真是物美价廉…<br><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/33267310.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/83815322.jpg" alt=""></p>
<ul>
<li>熊猫基地</li>
</ul>
<p>十月一号早上八点就跟着简途旅行从宽窄巷子出发，开车将近四十分钟到达熊猫基地，一起去一睹国宝的风采。</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/46439784.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/73561890.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/52524931.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/9753954.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/95987309.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/96856872.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/23171991.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/6256145.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/35696951.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/70523918.jpg" alt=""></p>
<ul>
<li>小龙坎（耍都店）</li>
</ul>
<p>从熊猫基地返回宽窄巷子的时候，差不多下午两点，在门口的廖记棒棒鸡吃了些，回到酒店休息会，就估摸着去尝尝火爆的小龙坎，火锅底料真不错，不过菜就觉得不是太新鲜了…</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/14354094.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/34427124.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/18646684.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/58378206.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/96437093.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/72669350.jpg" alt=""></p>
<ul>
<li>宽窄巷子（厕所串串）</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/88189535.jpg" alt=""></p>
<ul>
<li>九眼桥酒吧</li>
</ul>
<p>晚上吃完小龙坎，寻思着明天要离开成都了，就骑着小黄车去九眼桥酒吧坐了会儿，太商业化了…</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/38877856.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/97316563.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/94540051.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/94225801.jpg" alt=""></p>
<h2 id="第二站：海螺沟（10-2-10-4）"><a href="#第二站：海螺沟（10-2-10-4）" class="headerlink" title="第二站：海螺沟（10.2-10.4）"></a>第二站：海螺沟（10.2-10.4）</h2><p>十月二号上午十点，和其他六个人一起拼车去海螺沟，这一路将近八百公里，开了将近九个小时，晚上七点左右才到磨西小镇。</p>
<ul>
<li>磨西小镇</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/54729386.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/56242164.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/29340126.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/82514758.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/6254174.jpg" alt=""></p>
<ul>
<li>竹影农庄</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/40518041.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/47865357.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/37907724.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/26494132.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/10366058.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/87293981.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/70481539.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/30643778.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/29496428.jpg" alt=""></p>
<ul>
<li>海螺沟冰川公园</li>
</ul>
<p>十月三号，早上乘景区大巴，行驶将近一个小时到达三号营地，今天阴雨，乘索道到四号营地也看不到贡嘎雪山，就徒步到一个半小时去摸摸冰川也不算白来了。这里的空气真是清新，不过运气真是不好，什么也没看到，下午两点多准备返程的时候，说下山道路塌方，在阴雨中等了两个多小时大巴才恢复通车，真是又累又饿…</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/33891171.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/22517819.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/62078759.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/84455686.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/26813345.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/26027108.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/92071898.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/74860622.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/93921332.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/72670675.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/27212312.jpg" alt=""></p>
<ul>
<li>甘孜-泸定-雅安-峨眉山</li>
</ul>
<p>之前没有预定到从海螺沟到峨眉山的车次，所以十月四号一大早五点半就起床，赶到甘孜客运站</p>
<ol>
<li>甘孜-泸定 早上7点，行驶将近一个半小时，差点没赶上大巴</li>
<li>泸定-雅安 早上8点半，行驶将近四个小时，没赶上中午12点20到峨眉山的大巴</li>
<li>雅安-峨眉山 下午2点20，行驶将近两个小时，下午4点10分左右，终于抵达峨眉山报国寺</li>
</ol>
<h2 id="第三站：峨眉山（10-4-10-5）"><a href="#第三站：峨眉山（10-4-10-5）" class="headerlink" title="第三站：峨眉山（10.4-10.5）"></a>第三站：峨眉山（10.4-10.5）</h2><p>本来估摸着这次来时间不够只能去看看猴子，到酒店稍作休息，四号晚上五点多到报国寺客运站，算了算游览时间，从客运站到雷洞坪三个小时左右，虽然仓促，不上金顶还真是有些不甘心，就预定了往返雷洞坪的大巴。</p>
<p>五号一大早五点起床，乘坐六点的大巴车，赶往雷洞坪。一下车就看到白茫茫的云海，真是人间仙景，不虚此行！</p>
<ul>
<li>报国寺-万国寺-雷洞坪-索道</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/5649403.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/59887735.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/88221903.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/52559591.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/6483228.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/72279156.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/85357599.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/95275607.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/49774378.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/39917950.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/96128669.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-9/76322252.jpg" alt=""></p>
<ul>
<li>金顶</li>
</ul>
<p>在金顶上逛了一个半小时，要去会会猴子，十一点半开始返程去五显岗…</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/94114889.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/35658282.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/24515415.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/16740392.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/45147989.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/34056866.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/39288278.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/81754472.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/70667482.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/43868553.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/78575575.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/21579622.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/68542372.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/79265610.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/645296.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/94362163.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/44893757.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/17917687.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/98063587.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/32166427.jpg" alt=""></p>
<ul>
<li>五显岗-清音阁-生态猴区</li>
</ul>
<p>下午一点二十左右抵达，因时间紧迫，走了将近半个小时还没见到，路上接连打听要多久，回复还有十五分钟，走到两点四十，快绝望准备在三点还没见到就必须要返回的时候，终于看到了传说中猖狂的猴群…</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/69482423.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/15361592.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/67384497.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/75352122.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/77347799.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/36858285.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/7311742.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/22869124.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/14578269.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/18898637.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/88926238.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/98039602.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/74586855.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/7290445.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/69739662.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/2168985.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/13567476.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/14011147.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/10785746.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/25470865.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/92378794.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/58373920.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/41665098.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/64942051.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/42449757.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/8990408.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/97559634.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/29507195.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/60268272.jpg" alt=""></p>
<ul>
<li>峨眉山站-成都东站-重庆北站</li>
</ul>
<p>下午三点从猴区返回，又暴走一个半小时才回到五显岗停车场，下午五点四十一的高铁去重庆，这一路狂奔，到峨眉山站的时候就差十分钟，真是惊险…</p>
<p>坐在高铁上，两人已经气喘吁吁，毫无力气，商量着把重庆的行程缩短一天，退掉了七号的飞机和酒店，在重庆逛一逛就回上海休息了…</p>
<h2 id="第四站：重庆（10-5-10-6）"><a href="#第四站：重庆（10-5-10-6）" class="headerlink" title="第四站：重庆（10.5-10.6）"></a>第四站：重庆（10.5-10.6）</h2><ul>
<li>观音桥步行街</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/89697521.jpg" alt=""></p>
<ul>
<li>解放碑</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/62112950.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/64889156.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/5500972.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/67841458.jpg" alt=""></p>
<ul>
<li>洪崖洞</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/38657999.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/19602873.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/91178233.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/4529761.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/70689562.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/42679374.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/6571918.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/96022159.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/53931885.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/40325827.jpg" alt=""></p>
<ul>
<li>磁器口</li>
</ul>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/6376257.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/98851003.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/33959886.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/94644038.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-10-10/11170067.jpg" alt=""></p>
<p>六号晚上八点重庆江北机场的飞机，十点二十到上海浦东国际机场，预约了携程超级巴士，到家已经十二点多了，这一路终于到家了…</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><ul>
<li>做好时间规划</li>
<li>同一地点酒店预定同一家</li>
<li>不要轻易放弃</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2017/08/01/iOS/iOS App启动优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/01/iOS/iOS App启动优化/" itemprop="url">iOS App启动优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-01T10:58:40+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>T（App总启动时间）= T1（Main()之前的加载时间）+ T2（Main()之后的加载时间）</p>
<p>T1 = 系统dylib（动态链接库）和自身App可执行文件的加载</p>
<p>T2 = Main()方法执行之后到AppDelegat类中的<code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code>方法执行结束前的这段时间，主要是构建每一个页面，并完成渲染展示</p>
<h4 id="T1优化"><a href="#T1优化" class="headerlink" title="T1优化"></a>T1优化</h4><p>如何统计T1的耗时呢？苹果官方提供了一种方法，在真机调试的时候勾选<code>DYLD_PRINT_STATISTICS</code>选项，如下图所示：<br><img src="http://oqleb1k16.bkt.clouddn.com/17-8-1/11834328.jpg" alt=""></p>
<p>启动App后会得到如下形式的输出：<br><img src="http://oqleb1k16.bkt.clouddn.com/17-8-1/98374100.jpg" alt=""></p>
<p>现在来看看动态链接库加载的具体流程，分为四步：</p>
<ol>
<li>dylib loading</li>
<li>rebase/binding</li>
<li>ObjC setup</li>
<li>initializers</li>
</ol>
<h6 id="dylib-loading"><a href="#dylib-loading" class="headerlink" title="dylib loading"></a>dylib loading</h6><p>在每个动态库的加载过程中，dylib需要：</p>
<ol>
<li>分析所依赖的动态库</li>
<li>找到动态库的mach-o文件</li>
<li>打开文件</li>
<li>验证文件</li>
<li>在系统核心注册文件签名</li>
<li>对动态库的每一个segment调用mmap()</li>
</ol>
<p>通常，一个App需要加载100到400个dylibs，其中的系统库被优化，可以很快加载。针对这一步骤优化项如下：</p>
<ol>
<li>减少非系统库的依赖</li>
<li>合并非系统库</li>
<li>使用静态资源，比如把代码加入主程序</li>
</ol>
<h6 id="rebase-binding"><a href="#rebase-binding" class="headerlink" title="rebase/binding"></a>rebase/binding</h6><p>由于ASLR(address space layout randomization)的存在，可执行文件和动态链接库在虚拟内存中加载地址每次启动都不固定，所以需要这两步来修复镜像中的资源指针，来指向正确的地址。rebase修复的是指向当前镜像内部的资源指针；binding指向的是镜像外部的资源指针。</p>
<p>rebase步骤先进行，需要把镜像读入内存，并以page为单位加密验证，保证不会被篡改，所以这一步的瓶颈在IO。binding在其后进行，由于要查询符号表，来指向跨镜像的资源，加上在rebase阶段，镜像已经被读入和加密验证，所以这一步的瓶颈在于CPU计算。</p>
<p>通过命令行可以查看相关的资源指针：</p>
<p><code>xcrun dyldinfo -rebase -bind -lazy_bind /Users/BeiWang/Desktop/SZ/Production/iOS/ShanZhenV1.0.0\ 2016-08-03\ 16-12-15/ShanZhen/Payload/ShanZhen.app/ShanZhen</code></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-8-1/45743236.jpg" alt=""></p>
<p>优化该阶段的关键在于减少__DATA segment中的指针数量，可以优化的点有：</p>
<ol>
<li>减少ObjC类数量，减少selector数量</li>
<li>减少C++虚函数数量</li>
<li>转而使用swift struct（其实本质上就是减少符号的数量）</li>
</ol>
<h6 id="ObjC-setup"><a href="#ObjC-setup" class="headerlink" title="ObjC setup"></a>ObjC setup</h6><p>这一步的主要工作是：</p>
<ol>
<li>注册ObjC类</li>
<li>把category的定义插入方法列表</li>
<li>保证每一个selector唯一</li>
</ol>
<h6 id="initializers"><a href="#initializers" class="headerlink" title="initializers"></a>initializers</h6><p>以上三步属于静态调整，都是在修改 __DATA segment中的内容，而这里开始动态调整，开始在堆和堆栈中写入内容。在这里的工作有：</p>
<ol>
<li>ObjC的<code>+load()</code>函数</li>
<li>C++的构造函数属性函数</li>
<li>非基本类型的C++静态全局变量的创建（通常是类或结构体）</li>
</ol>
<p>总而言之，对于Main()调用之前的耗时可以优化的点如下：</p>
<ol>
<li>减少不必要的framework，因为动态链接比较耗时</li>
<li>check framework应当设为optional和required，如果该framework在当前App支持的所有iOS系统版本都存在，那么就设为required，否则设为optional，因为optional会有额外的检查</li>
<li>合并或删减一些OC类，可使用AppCode代码检查功能清理项目中没用到的类</li>
<li>删减一些无用的静态变量</li>
<li>删减没有被调用到或已经废弃的方法</li>
<li>将不必须在<code>+load()</code>方法中做的事情延迟到<code>+initialize()</code>中进行</li>
<li>尽量不要用C++虚函数（创建虚函数表有开销）</li>
</ol>
<h4 id="T2优化"><a href="#T2优化" class="headerlink" title="T2优化"></a>T2优化</h4><p>在Main()被调用之后，App的主要工作就是初始化必要的服务，显示首页内容等。App通常在AppDelegate类中的<code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code>方法中创建首页需要展示的View，然后在当前runloop的末尾，主要调用CA:Transaction:commit完成视图的渲染。而视图的渲染主要涉及四个阶段：</p>
<ol>
<li>准备阶段，主要是图片的解码</li>
<li>布局阶段，首页所有UIView的<code>- (void)layoutSubViews()</code>运行</li>
<li>绘制阶段，首页所有UIView的<code>- (void)drawRect:(CGRect)rect</code>运行</li>
<li>启动之后，必要服务的启动、必要数据的创建和读取</li>
</ol>
<p>因此，对于Main()函数调用之后可以优化的点如下：</p>
<ol>
<li>不使用xib，直接使用代码加载首页视图</li>
<li>每次用NSLog方式打印会隐式创建一个Calendar，因此需要删减启动时各业务方打的log，或仅仅针对内测版输出log</li>
<li>梳理应用启动时发送的所有网络请求，是否可以统一在异步线程中请求</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2017/06/28/architecture/MVVM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/architecture/MVVM/" itemprop="url">MVVM简析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-28T16:19:53+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="MVVM结构图"><a href="#MVVM结构图" class="headerlink" title="* MVVM结构图"></a>* MVVM结构图</h5><p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-28/58010754.jpg" alt=""></p>
<p>MVVM除了由Model、View、View-Model组成外，还有一个非常重要的隐含组件Binder：</p>
<ol>
<li><p>Model：源数据（来自数据库、网络请求等）。</p>
</li>
<li><p>View：由View和Controller组成，负责UI展示，绑定ViewModel中的属性，触发View-Model中的命令以及呈现由ViewModel提供的数据。</p>
</li>
<li><p>View-Model：它的主要职责一是作为表现视图显示自身所需要的静态模型；二是收集、解释和转换这些数据。主要是从MVC的Controller中抽取出来的展示逻辑，负责从Model中获取View所需要的数据，转换成View可以展示的数据，并暴露公开的属性和命令供View进行绑定。</p>
</li>
<li><p>Binder：主要是实现View和ViewModel间的数据绑定。</p>
</li>
</ol>
<h5 id="MVVM与MVC联系"><a href="#MVVM与MVC联系" class="headerlink" title="* MVVM与MVC联系"></a>* MVVM与MVC联系</h5><p>根据MVC和MVVM的职责划分，图解更清晰地反映出实际开发中组件间的关系方法，视图区块尺寸大致可以理解成它们对应负责的工作量，可以看出ViewController和View-Model间有大块工作上的重合，也可以看出ViewController在MVVM中有一部分是和View重合的。</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-28/47436687.jpg" alt=""></p>
<p>View-Model一词的确不能充分表达其职责，无法顾名思义。View Coordinator可能更好的表达View-Model的意图，View-Model从必要的资源（数据库、网络请求等）中获取原始数据，根据视图的展示逻辑，并处理成View(Controller)的展示数据。</p>
<p>View-Model存在的目的在于抽离ViewController中展示的业务逻辑，也就是MVC中C和MVVM中VM的重合部分，而不是替代ViewController。</p>
<p>MVVM动态变形：</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-28/98200354.jpg" alt=""></p>
<p>MVVM最终形态：</p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-28/83426722.jpg" alt=""></p>
<h5 id="MVVM模块层级图"><a href="#MVVM模块层级图" class="headerlink" title="* MVVM模块层级图"></a>* MVVM模块层级图</h5><p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-28/34399251.jpg" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://begodya.com/2017/06/01/world/嵊泗/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bei Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Begodya">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/01/world/嵊泗/" itemprop="url">世界迷雾之嵊泗</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-01T14:24:56+08:00">
                2017-06-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2017年5月29日，端午前夕，上海天气晴朗</p>
<h2 id="路线"><a href="#路线" class="headerlink" title="路线"></a>路线</h2><p>从南浦大桥集散地，乘车约一个半小时至沈家湾码头，再乘船约一个小时至李柱山码头。<br><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/79761278.jpg" alt=""></p>
<h2 id="酒店"><a href="#酒店" class="headerlink" title="酒店"></a>酒店</h2><p>李柱山码头位于嵊泗本岛的最北端，酒店在最南端，濒临南长途沙滩，两地相隔近十公里；吹着海风，看着海景也是相当宜人的。<br><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/96750842.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/71163196.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/43059808.jpg" alt=""></p>
<h2 id="山路"><a href="#山路" class="headerlink" title="山路"></a>山路</h2><p>小岛天气舒适，空气清新，海风阵阵，沿海山路干净整洁，植被繁茂。<br><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/77928929.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/7213467.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/93196142.jpg" alt=""></p>
<h2 id="基湖"><a href="#基湖" class="headerlink" title="基湖"></a>基湖</h2><p>嵊泗本岛有两处沙滩，基湖沙滩周边商业开发齐全，周边旅馆、餐饮、交通比较便利；而另一处南长途沙滩，尚在开发中，游客较少，周边的航海广场也是门可罗雀；不过两处沙滩相距也仅三四公里，步行三四十分钟即可到达。<br><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/6634964.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/60566947.jpg" alt=""></p>
<p><img src="http://oqleb1k16.bkt.clouddn.com/17-6-1/66856448.jpg" alt=""></p>
<p>在嵊泗本岛环岛游两天，大多游客主要集中在菜园镇附近，是一个适合短期的休闲度假，放松心情的好去处~</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars3.githubusercontent.com/u/4849945?v=3&u=2fc94e38699ed5ca25f46fe2c62682991c8faa21&s=400"
               alt="Bei Wang" />
          <p class="site-author-name" itemprop="name">Bei Wang</p>
           
              <p class="site-description motion-element" itemprop="description">『修身养性，寻找灵感』</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/begodya" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/begodya" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/3096695943/profile?topnav=1&wvr=6&is_all=1" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bei Wang</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
